<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Modifica Profilo</title>
    <link rel="stylesheet" th:href="@{/css/editProfile.css}" />
</head>
<body>

    <div class="profile-container">
        <h2>Modifica il tuo profilo</h2>
        <form th:action="@{/profile/edit}" method="post">
            <label for="nome">Nome:</label>
            <input type="text" id="nome" name="nome" th:value="${utente.nome}" required><br>

            <label for="cognome">Cognome:</label>
            <input type="text" id="cognome" name="cognome" th:value="${utente.cognome}" required><br>

            <label for="email">Email:</label>
            <input type="email" id="email" name="email" th:value="${utente.email}" required><br>

            <label for="corsoDiStudi">Corso di Studi:</label>
            <input type="text" id="corsoDiStudi" name="corsoDiStudi" th:value="${utente.corsoDiStudi}"><br>

            <label>
                <input type="checkbox" name="disponibileRipetizioni"
                       th:checked="${utente.disponibileRipetizioni}" />
                Disponibile per ripetizioni
            </label><br>

            <!-- Seleziona immagine profilo -->
            <label for="immagineProfilo">Seleziona immagine profilo:</label>
            <div class="custom-dropdown">
                <div class="dropdown-selected" id="selected-avatar">
                    <img th:src="${utente.immagineProfilo}" alt="Avatar selezionato" class="avatar-img" /> Seleziona Avatar
                </div>
                <div class="dropdown-options" id="avatar-options">
                    <div class="avatar-option" data-value="/media/avatar1.png">
                        <img src="/media/avatar1.png" alt="Avatar 1" class="avatar-img" /> Avatar 1
                    </div>
                    <div class="avatar-option" data-value="/media/avatar2.png">
                        <img src="/media/avatar2.png" alt="Avatar 2" class="avatar-img" /> Avatar 2
                    </div>
                    <div class="avatar-option" data-value="/media/avatar3.png">
                        <img src="/media/avatar3.png" alt="Avatar 3" class="avatar-img" /> Avatar 3
                    </div>
                </div>
                <input type="hidden" name="immagineProfilo" id="immagineProfilo" th:value="${utente.immagineProfilo}" required />
            </div>

            <button type="submit">Salva Modifiche</button>
        </form>

        <a href="/profile" class="back-button">Annulla</a>
    </div>

    <script>
        const avatarOptions = document.querySelectorAll('.avatar-option');
        const selectedAvatar = document.getElementById('selected-avatar');
        const hiddenInput = document.getElementById('immagineProfilo');

        avatarOptions.forEach(option => {
            option.addEventListener('click', function() {
                selectedAvatar.innerHTML = `<img src="${this.querySelector('img').src}" class="avatar-img" /> ${this.textContent}`;
                hiddenInput.value = this.dataset.value;
                document.getElementById('avatar-options').classList.toggle('show');
            });
        });

        selectedAvatar.addEventListener('click', function() {
            document.getElementById('avatar-options').classList.toggle('show');
        });
    </script>

</body>
</html>
